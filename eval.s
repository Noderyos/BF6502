	.setcpu "65C02"
	.segment "CODE"

; A => CURRENT INSTRUCTION
; X => CURRENT ADBDR
; Y => ARR_INDEX

EXEC:
	LDA #$00
	TAX
	TAY
BFLOOP:
	LDA IN, X
	INX 

	CMP #'+'
	BEQ INCR
	CMP #'-'
	BEQ DECR

	CMP #'>'
	BEQ RIGHT
	CMP #'<'
	BEQ LEFT

	CMP #'.'
	BEQ COUT
	CMP #','
	BEQ CIN

	CMP #'['
	BEQ LSTART
	CMP #']'
	BEQ LEND

FALL:
	JMP FALL

INCR:
	LDA BFARR, Y
	INA
	STA BFARR, Y
	JMP BFLOOP
DECR:
	LDA BFARR, Y
	DEA
	STA BFARR, Y
	JMP BFLOOP

RIGHT:
	INY
	JMP BFLOOP
LEFT:
	DEY
	JMP BFLOOP

COUT:
	LDA BFARR, Y
	PHY
	JSR CHROUT
	PLY
	JMP BFLOOP
CIN:
	JSR CHRIN
	STA BFARR, Y
	JMP BFLOOP

LSTART:
	DEX
	PHX
	INX
	JMP BFLOOP


LEND:
	LDA BFARR, Y 
	CMP #$00
	BEQ NOLOOP
	PLX
NOLOOP:
	JMP BFLOOP